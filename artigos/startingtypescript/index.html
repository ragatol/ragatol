<!DOCTYPE html>
<html lang="pt">
<head>
    <title>Rafael Fernandes - Iniciando o uso do TypeScript</title>
  <meta charset="utf-8" />
  <!-- link para outros arquivos do thema (css e javascript) -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans%7CRoboto+Mono%7CUbuntu+Condensed" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/theme/site.css">
  <link rel="stylesheet" type="text/css" href="/theme/codehighlight.css">
	

    <meta name="description" content="Uma breve introdu√ß√£o ao TypeScript utilizando ele para criar uma simples anima√ß√£o aleat√≥ria utilizando o elemento Canvas." />

    <meta name="tags" content="programa√ß√£o" />
    <meta name="tags" content="Typescript" />
    <meta name="tags" content="Javascript" />

</head>
<body>
  <header id="site_header" class="background  ">
    <div class="sitewidth">
    <h6><a href="/">Rafael Fernandes</a></h6>
    <nav id="topmenu"><ul>
      <li class="active"><a href="/category/artigos.html">Artigos</a></li>
      <li><a href="/category/projetos.html">Projetos</a></li>
      <li><a href="/about/">Sobre</a></li>
    </ul></nav><!-- /#menu -->
    </div>
  </header>

  <!-- Page content -->
<main class="article_page">
  <article>
    <h1>Iniciando o uso do TypeScript</h1>
    <aside class="translations">
<p>Translations:</p>
<ul>
    <li><a href="/artigos/startingtypescript/en.html">en</a></li>
</ul>
</aside>

    <p>Sendo um programador mais voltado para C++, come√ßo meio atrasado a dar uma olhada nessa nova onda de Node.js e TypeScript e tudo mais.
Mas depois de ter assistido √† uma apresenta√ß√£o sobre TypeScript da Microsoft, fiquei interessado em utilizar, j√° que Javascript √©
sofr√≠vel quando voc√™ come√ßa a criar aplica√ß√µes mais complexas. As dificuldades do Javascript ficam ainda mais
evidentes agora com todas essas novidades nas vers√µes mais recentes do C++ e at√© mesmo linguagens novas como Swift.
Sei que h√° a vers√£o ES2015 (ECMAScript 2015), mas ela na pr√°tica n√£o pode ser utilizada, por falta de suporte nos navegadores mais utilizados.</p>
<p>Ent√£o nada melhor que colocar o TypeScript √† prova fazendo uma simples aplica√ß√£o interessante. üòÅ</p>
<h2>O que faz o TypeScript</h2>
<p>TypeScript √© uma extens√£o do antigo Javascript. A extens√£o mais evidente √© utiliza√ß√£o de tipos e a verifica√ß√£o, durante a compila√ß√£o,
de erros relacionados a utiliza√ß√£o errada de tipos, algo n√£o dispon√≠vel ao Javascript.</p>
<p>Mas o que mais me interessa nele √© o fato dele apenas traduzir c√≥digo em TypeScript para Javascript comum, de acordo com suas
necessidades. Por causa disso, voc√™ pode utilizar todas as novas funcionalidades existentes apenas no ES2015 e ainda assim
ter seu c√≥digo funcionando em navegadores antigos que suportam apenas ES3. Isso por si s√≥ j√° √© mais do que suficiente
para que deixe de usar Javascript diretamente, e come√ßar a criar c√≥digo novo exclusivamente no TypeScript.</p>
<p>Como ele √© um tradutor e verificador de c√≥digo, temos que instalar ele de forma que seja utilizado pelo editor
√† sua escolha.</p>
<h2>Instalando e Configurando o TypeScript</h2>
<p>Se voc√™ faz uso do VisualStudio 2013 Update 2 ou superior, o compilador do TypeScript j√° √© instalado por padr√£o.
Caso contr√°rio, temos que instal√°-lo para utilizar ele com editor de sua prefer√™ncia (no meu caso, √© o <a href="https://code.visualstudio.com/">Visual Studio Code</a>).</p>
<p>Como compilador do TypeScript √© feito em cima do <a href="https://nodejs.org/">Node.js</a>, ent√£o a primeira coisa √© instalar ele.</p>
<p>Depois de instalado o Node.js, √© s√≥ adicionar o TypeScript pelo console:</p>
<div class="highlight"><pre><span></span>npm install -g typescript
</pre></div>


<p>Pronto, j√° podemos compilar c√≥digo TypeScript para Javascript usando o console:</p>
<div class="highlight"><pre><span></span>tsc source.ts
</pre></div>


<p>que criar√° o arquivo <code>source.js</code>!</p>
<h3>Configura√ß√µes do Compilador</h3>
<p>Na mesma pasta onde est√£o seus arquivos de c√≥digo-fonte, √© s√≥ criar um arquivo tsconfig.json. No exemplo deste artigo,
o arquivo tem o seguinte conte√∫do:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;compileOnSave&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">&quot;compilerOptions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;es3&quot;</span><span class="p">,</span>
        <span class="nt">&quot;module&quot;</span><span class="p">:</span> <span class="s2">&quot;commonjs&quot;</span><span class="p">,</span>
        <span class="nt">&quot;sourceMap&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="nt">&quot;noEmitOnError&quot;</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Esta configura√ß√£o diz para o compilador gerar c√≥digo Javascript no padr√£o ES3, utilizando como base um interpretador padr√£o. A op√ß√£o
<code>sourceMap</code> gera um arquivo <strong>.map</strong> que pode ser utilizado pelo Firefox para fazer a rela√ß√£o entre o c√≥digo em TypeScript e o c√≥digo
em Javascript durante uma sess√£o de depura√ß√£o. A op√ß√£o <code>noEmitOnError</code> diz para o compilador n√£o gerar nenhum arquivo caso haja algum
erro no nosso c√≥digo-fonte, evitando assim sobrescrever o arquivo <strong>.js</strong> que esteja funcionando corretamente.</p>
<p>Caso esteja usando o Visual Studio Code, s√≥ precisamos criar uma <em>task</em> que compila nosso arquivo <strong>.ts</strong> sempre que salvarmos.
Abrindo o Command Palette, √© s√≥ digitar <code>task</code> e escolher <strong>Configure Task Runner</strong> e depois <strong>TypeScript - Watch Mode</strong>, para que
o editor gere a configura√ß√£o necess√°ria. Depois disso √© s√≥ iniciar a <em>task</em> com o comando <strong>Run Build Task</strong>.</p>
<h3>Criando os arquivos necess√°rios</h3>
<p>Primeiro √© necess√°rio preparar o HTML que vamos utilizar para carregar nosso script e ter o <code>canvas</code> necess√°rio para desenhar.
Criei o arquivo <strong>canvas.html</strong> e fiz apenas o necess√°rio para termos o que precisamos:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;!DOCTYPE hmtl&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Teste Canvas<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">canvas</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;tela&quot;</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;640&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;480&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">canvas</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;canvas.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>


<p>E tamb√©m criei o arquivo <strong>canvas.ts</strong> que ser√° o c√≥digo fonte do nosso pequeno teste.</p>
<h2>Criando o Script</h2>
<p>Para ter acesso ao <code>canvas</code> e poder desenhar qualquer coisa nele, primeiro √© necess√°rio ter o contexto 2D. Al√©m disso,
tamb√©m configuramos algumas constantes para que o restante do programa saiba os limites de nosso canvas.</p>
<div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">tela</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;tela&quot;</span><span class="p">)</span> <span class="kr">as</span> <span class="nx">HTMLCanvasElement</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">tela</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">backgroundColor</span> <span class="o">=</span> <span class="s2">&quot;#000&quot;</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">width</span> <span class="o">=</span> <span class="nx">tela</span><span class="p">.</span><span class="nx">width</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">height</span> <span class="o">=</span> <span class="nx">tela</span><span class="p">.</span><span class="nx">height</span><span class="p">;</span>

<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="nx">backgroundColor</span><span class="p">;</span>
<span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="p">);</span>
</pre></div>


<p>Nas duas primeiras linhas, pegamos o elemento <strong>canvas</strong> e depois pegamos o contexto 2D para uso posterior.
Depois, definimos 3 constantes, que s√£o utilizados pelo restante do script, e finalmente, iniciamos
o nosso canvas com um ret√¢ngulo preenchido de preto, para podermos verificar no navegador que est√°
funcionando.</p>
<p>Um detalhe importante j√° no come√ßo √© que temos que dizer para o TypeScript que o elemento retornado
pela chamada <strong>document.getElementById</strong> √© de fato um elemento <strong>canvas</strong>, da√≠ a necessidade de
converter o tipo <strong>HTMLElement</strong> para <strong>HTMLCanvasElement</strong> usando a palavra-chave <strong>as</strong>, j√° que
no tipo <strong>HTMLElement</strong> n√£o existe o m√©todo <strong>getContext</strong>.</p>
<h3>Criando Classes</h3>
<p>Nosso pequeno projeto tem como objetivo colocar v√°rios objetos geom√©tricos compostos por variada
quantidade de pontos que se movimento pela tela, inspirado na antiga prote√ß√£o de tela cl√°ssica
do Windows, <strong><em>Pol√≠gonos</em></strong>.</p>
<p>A primeira classe que precisamos √© como representar um ponto, composto de duas coordenadas <strong>x</strong> e <strong>y</strong>.
Al√©m disso, como vamos movimentar o ponto pela tela, tamb√©m devemos adicionar uma opera√ß√£o para mover o ponto
em uma determinada dire√ß√£o repesentada por outro conjunto de coordenadas. Ent√£o temos a classe <strong><em>Vector</em></strong>.</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">Vector</span> <span class="p">{</span>
    <span class="nx">x</span>: <span class="kt">number</span><span class="p">;</span>
    <span class="nx">y</span>: <span class="kt">number</span><span class="p">;</span>

    <span class="kr">constructor</span><span class="p">(</span> <span class="nx">x</span>:<span class="kt">number</span> <span class="p">,</span> <span class="nx">y</span>:<span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">x</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">y</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">add</span><span class="p">(</span><span class="nx">o</span>:<span class="kt">Vector</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="nx">o</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Tendo nossa classe <em><strong>Vector</strong></em> para representar uma coordenada 2D, agora podemos criar a classe que
representa um ponto com uma dire√ß√£o, que se move pela tela, se rebatendo pelos cantos. Al√©m das informa√ß√µes
de posi√ß√£o e dire√ß√£o, tamb√©m vamos adicionar um m√©todo para fazer esse movimento a cada atualiza√ß√£o.
Vamos cham√°-la de <strong><em>MovingPoint</em></strong>.</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">MovingPoint</span> <span class="p">{</span>
    <span class="nx">position</span>: <span class="kt">Vector</span><span class="p">;</span>
    <span class="nx">direction</span>: <span class="kt">Vector</span><span class="p">;</span>

    <span class="kr">constructor</span><span class="p">(</span><span class="nx">position</span>:<span class="kt">Vector</span><span class="p">,</span><span class="nx">direction</span>:<span class="kt">Vector</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">position</span> <span class="o">=</span> <span class="nx">position</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">direction</span> <span class="o">=</span> <span class="nx">direction</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">move() {</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;=</span> <span class="nx">width</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;=</span> <span class="nx">height</span><span class="p">)</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="o">-</span><span class="k">this</span><span class="p">.</span><span class="nx">direction</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Tamb√©m precisamos de uma classe que represente um conjunto de pontos formando um pol√≠gono... 
Mas antes, como queremos que cada pol√≠gono seja criado aleatoriamente, vamos fazer algumas
fun√ß√µes auxiliares:
- <strong><em>randomPos</em></strong> cria uma posi√ß√£o aleat√≥ria dentro dos limites do nosso <strong>canvas</strong>.
- <strong><em>randomSpeed</em></strong> gera uma velocidade (positiva ou negativa) dentro dos par√¢metros.
- <strong><em>randomDir</em></strong> cria uma dire√ß√£o com uma velocidade aleat√≥ria nos eixos <strong>X</strong> e <strong>Y</strong>.</p>
<div class="highlight"><pre><span></span><span class="kd">function</span> <span class="nx">randomPos</span><span class="p">(</span><span class="nx">width</span>:<span class="kt">number</span><span class="p">,</span><span class="nx">height</span>:<span class="kt">number</span><span class="p">)</span><span class="o">:</span> <span class="nx">Vector</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">width</span><span class="p">;</span>
    <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">height</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Vector</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">randomSpeed</span><span class="p">(</span><span class="nx">min</span>:<span class="kt">number</span><span class="p">,</span> <span class="nx">max</span>:<span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">val</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nx">max</span><span class="p">)</span> <span class="o">-</span> <span class="nx">max</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span> <span class="o">&lt;</span> <span class="nx">min</span><span class="p">)</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">min</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span> <span class="o">&gt;</span> <span class="o">-</span><span class="nx">min</span><span class="p">)</span> <span class="nx">val</span> <span class="o">=</span> <span class="o">-</span><span class="nx">min</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">val</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">randomDir</span><span class="p">(</span><span class="nx">minSpeed</span>:<span class="kt">number</span><span class="p">,</span> <span class="nx">maxSpeed</span>:<span class="kt">number</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">randomSpeed</span><span class="p">(</span><span class="nx">minSpeed</span><span class="p">,</span><span class="nx">maxSpeed</span><span class="p">);</span>
    <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="nx">randomSpeed</span><span class="p">(</span><span class="nx">minSpeed</span><span class="p">,</span><span class="nx">maxSpeed</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">Vector</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>


<p>Agora sim, s√≥ precisamos criar uma classe que √© um conjunto de pontos, no m√≠nimo 2 (uma linha), que ser√° desenhada na tela
em uma determinada cor a cada atualiza√ß√£o. Tamb√©m configuramos a cor que ser√° utilizada e se √© um pol√≠gono fechado
ou n√£o. Ser√° nossa classe <strong><em>Polygon</em></strong>.</p>
<p>Al√©m disso, vamos criar 2 m√©todos para que o pol√≠gono mova seus pontos e se desenhe no <strong>canvas</strong> a cada atualiza√ß√£o.</p>
<div class="highlight"><pre><span></span><span class="kr">class</span> <span class="nx">Polygon</span> <span class="p">{</span>
    <span class="nx">points</span>: <span class="kt">MovingPoint</span><span class="p">[];</span>
    <span class="nx">color</span>: <span class="kt">string</span><span class="p">;</span>
    <span class="nx">open</span>: <span class="kt">boolean</span><span class="p">;</span>

    <span class="kr">constructor</span><span class="p">(</span><span class="nx">vectors</span>:<span class="kt">number</span><span class="p">,</span><span class="nx">color</span>:<span class="kt">string</span><span class="p">,</span><span class="nx">open</span>:<span class="kt">boolean</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">vectors</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">)</span> <span class="k">throw</span> <span class="nb">Error</span><span class="p">(</span><span class="s2">&quot;Need at least 2 poins!&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">vectors</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">open</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span> <span class="k">else</span> <span class="k">this</span><span class="p">.</span><span class="nx">open</span> <span class="o">=</span> <span class="nx">open</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">points</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="o">&lt;</span><span class="nx">MovingPoint</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">vectors</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MovingPoint</span><span class="p">(</span><span class="nx">randomPos</span><span class="p">(</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="p">),</span><span class="nx">randomDir</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">update() {</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">point</span> <span class="nx">of</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">point</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nx">draw</span><span class="p">(</span><span class="nx">ctx</span>:<span class="kt">CanvasRenderingContext2D</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">strokeStyle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
        <span class="kd">let</span> <span class="p">{</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">position</span><span class="p">;</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">let</span> <span class="p">{</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">position</span><span class="p">;</span>
            <span class="nx">ctx</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="nx">y</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">open</span><span class="p">)</span> <span class="nx">ctx</span><span class="p">.</span><span class="nx">closePath</span><span class="p">();</span>
        <span class="nx">ctx</span><span class="p">.</span><span class="nx">stroke</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Nesta classe usamos alguns dos v√°rios recursos dispon√≠veis apenas em ES2015 e TypeScript: no <strong>constructor</strong>, utilizamos
<strong><em>generics</em></strong> para criar um <strong>Array</strong> de tipo espec√≠fico; em <strong>update</strong>, utilizamos o novo <strong><em>for (let item of collection)</em></strong> que faz a itera√ß√£o
de todos os itens em uma cole√ß√£o; e em <strong>draw</strong> fazemos a <strong><em>desconstru√ß√£o</em></strong> do tipo <strong>Vector</strong> em 2 vari√°veis, para
deixar o c√≥digo mais leg√≠vel.</p>
<h2>Desenhando no Canvas</h2>
<p>Agora, s√≥ precisamos criar alguns objetos <strong><em>Polygon</em></strong>, criar uma fun√ß√£o que ser√° chamada a cada intervalo de atualiza√ß√£o e pronto!</p>
<div class="highlight"><pre><span></span><span class="kd">let</span> <span class="nx">objects</span>:<span class="kt">Polygon</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
    <span class="k">new</span> <span class="nx">Polygon</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;white&quot;</span><span class="p">),</span>
    <span class="k">new</span> <span class="nx">Polygon</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;orange&quot;</span><span class="p">),</span>
    <span class="k">new</span> <span class="nx">Polygon</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s2">&quot;rgb(100,150,255)&quot;</span><span class="p">)</span>
<span class="p">];</span>

<span class="kd">let</span> <span class="nx">render</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillStyle</span> <span class="o">=</span> <span class="s2">&quot;rgba(0,0,0,.075)&quot;</span><span class="p">;</span>
    <span class="nx">ctx</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="nx">width</span><span class="p">,</span><span class="nx">height</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">obj</span> <span class="nx">of</span> <span class="nx">objects</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">update</span><span class="p">();</span>
        <span class="nx">obj</span><span class="p">.</span><span class="nx">draw</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">renderingLoop</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">setInterval</span><span class="p">(</span><span class="nx">render</span><span class="p">,</span><span class="mi">33</span><span class="p">);</span>
</pre></div>


<p>Note que <strong>render</strong> utiliza a nova sintaxe para criar fun√ß√µes de callback no ES2015/TypeScript. Esta sintaxe nova j√°
cria os bindings necess√°rios que no ES3 devem ser feitos manualmente, deixando o c√≥digo mais leg√≠vel e com menos
chance de erros.</p>
<p>Agora √© s√≥ salvar o arquivo, ver o novo arquivo <strong>canvas.js</strong> ser criado na mesma pasta do projeto, e abrir nosso
html no navegador para <a href="/canvas/canvas.html">ver o resultado</a>!</p>
<ul>
<li>C√≥digo fonte: <a href="/canvas/canvas.ts">canvas.ts</a>;</li>
<li>C√≥gido gerado pelo TypeScript: <a href="/canvas/canvas.js">canvas.js</a>;</li>
</ul>
<h2>Refer√™ncias</h2>
<p>Node.js: <a href="https://nodejs.org/">https://nodejs.org/</a></p>
<p>TypeScript: <a href="https://www.typescriptlang.org/">https://www.typescriptlang.org/</a></p>
<p>Visual Studio Code: <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p>
<p>Canvas: <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API">https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API</a></p>
    <footer class="article_info">
      <summary>Informa√ß√µes do artigo:</summary>
      <p><time class="published" datetime="2016-09-14T00:00:00-03:00">
        Publicado em: qua 14 setembro 2016
      </time></p>
      <address class="vcard author">
        Autor:             <a href="/author/rafael-fernandes.html">Rafael Fernandes</a>
      </address>
      <p class="category">
          Categoria: <a href="/category/artigos.html">Artigos</a>
      </p>
      <p class="tags">
          Tags:
              <a href="/tag/programacao.html">programa√ß√£o</a>
              <a href="/tag/typescript.html">Typescript</a>
              <a href="/tag/javascript.html">Javascript</a>
      </p>
      <p class="extrainfo">Permalink: /artigos/startingtypescript/</p>
    </footer><!-- /.post-info -->
  </article>
</main>

  <footer id="site_footer" class="background">
    <p>
      <a href="http://twitter.com/ragatol" rel="bookmark"><img src="https://twitter.com/favicon.ico"> twitter</a> 
      <a href="http://github.com/ragatol" rel="bookmark"><img src="https://github.com/favicon.ico"> github</a>
    </p>
    <p>&copy; 2016 Rafael Fernandes</p>
  </footer><!-- /#contentinfo -->
</body>
</html>